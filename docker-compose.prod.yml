# Production Docker Compose Configuration
# Note: MongoDB is deployed separately in UAT/Production environments
# The MONGODB_URI environment variable should point to your external MongoDB instance
services:
    app:
        build:
            context: .
            dockerfile: Dockerfile.backend
        environment:
            MONGODB_URI: ${MONGODB_URI}
            PORT: ${PORT:-5050}
            NODE_ENV: production
            ADMIN_USERNAME: ${ADMIN_USERNAME:-admin}
            ADMIN_PASSWORD: ${ADMIN_PASSWORD:-password}
            # AWS Email Service Configuration
            EMAIL_SERVICE_SQS_URL: ${EMAIL_SERVICE_SQS_URL}
            AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
            AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
            AWS_REGION: ${AWS_REGION:-ap-southeast-2}
        ports:
            - '${PORT:-5050}:${PORT:-5050}'
        restart: unless-stopped
        logging:
            driver: 'json-file'
            options:
                max-size: '10m'
                max-file: '3'
        volumes:
            - uploads:/app/uploads

volumes:
    uploads:
